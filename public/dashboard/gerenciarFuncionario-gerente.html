<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard | Innovax</title>
    <link rel="shortcut icon" type="imagex/png" href="../assets/82-Sem-Título_20240828181654.ico">
    <link rel="stylesheet" href="./style/global.styles.css">
    <link rel="stylesheet" href="./style/dash.styles.css">



    <!-- FONTS -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
        href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap"
        rel="stylesheet" />
</head>

<body>
    <aside>
        <img src="../assets/logo.png" alt="">
        <p>Olá, <span id="b_usuario"></span>!</p>
        <nav>
            <ul>
                <li><a onmouseover="this.style.color='#00d300'" onmouseout="this.style.color='white'"
                        href="./dashboard.html"> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                            viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                            stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-house">
                            <path d="M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8" />
                            <path
                                d="M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z" />
                        </svg> <span>Dashboard</span></a></li>
                <li><a href="./atualizarDados.html" id="atualizarDados" onmouseover="this.style.color='#00d300'"
                        onmouseout="this.style.color='white'"><svg xmlns="http://www.w3.org/2000/svg" width="24"
                            height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                            stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-user">
                            <path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2" />
                            <circle cx="12" cy="7" r="4" />
                        </svg><span>Conta</span></a>
                </li>
                <span class="total">
                    <div class="atualizarDadosEmpresa">
                        <li><a href="./atualizarDadosEmpresa.html" id="atualizarDados"
                                onmouseover="this.style.color='#00d300'" onmouseout="this.style.color='white'"><svg
                                    xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                                    fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round" class="lucide lucide-user">
                                    <path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2" />
                                    <circle cx="12" cy="7" r="4" />
                                </svg><span>Conta Empresa</span></a>
                        </li>
                    </div>
                    <li class="cadastroFuncionario"><a href="./cadastroFuncionario.html"
                            onmouseover="this.style.color='#00d300'" onmouseout="this.style.color='white'"><svg
                                xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                                fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                stroke-linejoin="round" class="lucide lucide-badge-plus">
                                <path
                                    d="M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.77 4.78 4 4 0 0 1-6.75 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z" />
                                <line x1="12" x2="12" y1="8" y2="16" />
                                <line x1="8" x2="16" y1="12" y2="12" />
                            </svg><span>Cadastrar funcionário</span></a>
                    </li>
                    <li><a href="./personalizarSugestoes.html" onmouseover="this.style.color='#00d300'"
                            onmouseout="this.style.color='white'">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                                fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                stroke-linejoin="round" class="lucide lucide-square-pen">
                                <path d="M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7" />
                                <path
                                    d="M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z" />
                            </svg><span>Personalizar sugestões</span></a>
                    </li>
                    <li class="gerenciarFuncionario" id="gerenciarFuncionario"><a href="" style="background: #006622">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                                fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                stroke-linejoin="round" class="lucide lucide-users">
                                <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2" />
                                <circle cx="9" cy="7" r="4" />
                                <path d="M22 21v-2a4 4 0 0 0-3-3.87" />
                                <path d="M16 3.13a4 4 0 0 1 0 7.75" />
                            </svg><span>Gerenciar funcionários</span></a>
                    </li>
                </span>
            </ul>

            <li onclick="deslogar()" class="exit"><a href="#" onmouseover="this.style.color='#00d300'"
                    onmouseout="this.style.color='white'"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                        viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round" class="lucide lucide-log-out">
                        <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4" />
                        <polyline points="16 17 21 12 16 7" />
                        <line x1="21" x2="9" y1="12" y2="12" />
                    </svg><span>Sair</span></a></li>
        </nav>
    </aside>
    <main>
        <header>
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                    class="lucide lucide-clipboard-list">
                    <rect width="8" height="4" x="8" y="2" rx="1" ry="1" />
                    <path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2" />
                    <path d="M12 11h4" />
                    <path d="M12 16h4" />
                    <path d="M8 11h.01" />
                    <path d="M8 16h.01" />
                </svg>
                <h1>Gerenciar Funcionário</h1>
            </div>
            <p> Gerencie os funcionários </p>
        </header>

        <div class="funcionario-content">
            <table>
                <tr>
                    <td class="info-table-content">ID</td>
                    <td class="info-table-content">Nome</td>
                    <td class="info-table-content">CPF</td>
                    <td class="info-table-content">Email</td>
                    <td class="info-table-content">Cargo</td>
                    <td class="info-table-content">Deletar</td>

                </tr>
            </table>
            <div>
            </div>
        </div>

        <div id="warningDelete">
            <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                class="lucide lucide-shield-check">
                <path
                    d="M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z" />
                <path d="m9 12 2 2 4-4" />
            </svg>
            <div>
                <h3>Funcionário deletado com sucesso!</h3>
                <p>O funcionário foi deletado, recarregue a página para a visualização</p>
            </div>
        </div>
        <div id="warningEditar">
            <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                class="lucide lucide-shield-check">
                <path
                    d="M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z" />
                <path d="m9 12 2 2 4-4" />
            </svg>
        </div>

</body>

</html>



<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>

    function deslogar() {
        sessionStorage.clear()
        window.location = "../"
    }

    b_usuario.innerHTML = sessionStorage.NOME_USUARIO;
    if (sessionStorage.getItem('fkUserRole') === '3') {
        document.querySelector(".total").classList.add("display-none")
    } else if (sessionStorage.getItem('fkUserRole') === '2') {
        document.querySelector(".atualizarDadosEmpresa").style.display = 'none'
        document.querySelector("#gerenciarFuncionario a").href = "./gerenciarFuncionario-gerente.html";
    } else if (sessionStorage.getItem('fkUserRole') === '1') {
        document.querySelector("#gerenciarFuncionario a").href = "./gerenciarFuncionario.html";
    }

    var idEmpresa = sessionStorage.idEmpresa




    function gerarTabela(api) {

        

        const isGerente = sessionStorage.getItem('fkUserRole') === '2';
        const isRepresentante = sessionStorage.getItem('fkUserRole') === '1';

        const cardContent = document.querySelector("table")

        fetch(api)
            .then(response => response.json())
            .then(data => {
       

                let counter = 0;
                data.forEach(element => {

                    console.log(element.nome)

                    const table = document.createElement('tr')

                    if (isGerente && element.fkUserRole !== 3) {
                        return;
                    }

                    counter++


                    table.innerHTML = `
                    <td>${counter}</td>
                    <td>${element.nome}</td>
                    <td>${element.cpf == null ? "Não informado" : element.cpf}</td>
                    <td>${element.email}</td>
                    <td>${element.userRole}</td>
                    <td onclick="deletarFuncionario(${element.id})"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-trash-2"><path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/><line x1="10" x2="10" y1="11" y2="17"/><line x1="14" x2="14" y1="11" y2="17"/></svg></td>
                   `

                    cardContent.append(table)
                })

            })
            .catch(error => console.error(error))

    }

    gerarTabela(`/usuario/empresa/${idEmpresa}/usuario/${sessionStorage.ID_USUARIO}`);

    function deletarFuncionario(id) {
        fetch(`/usuario/deletar/${id}`, {
            method: "DELETE"
        })
            .then(response => {
                if (response.status == 204) {
                    warningDelete.style.display = "flex"

                    setTimeout(() => {
                        warningDelete.style.display = "none"
                        location.reload()
                    }, 3000)
                }
            })
            .catch(error => console.error(error))
    }





</script>